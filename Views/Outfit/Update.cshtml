@model Gimli.Models.OutfitViewModel

@{
    ViewData["Title"] = "Update";
}

<div class="container">
    <h4>Outfit Update Page</h4>
    <hr />
    <table class="table table-bordered table-striped table-hover">
        <tr>
            <th>Name</th>
            <td><input id="name" class="form-control" value="@Model.Outfit.Name" /></td>
        </tr>
        <tr>
            <th>Head</th>
            <td>
                @foreach (var item in Model.HeadClothes)
                {
                    <p>
                        <button class="btn" onclick="deleteHead(@Model.Outfit.Id, @item.Id)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z" />
                            </svg>
                        </button>@item.Name
                    </p>
                }
                <div id="headClothesPart"></div>
                <button onclick="getClothes('head')" class="btn" name="newButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square" style="margin-right:10px" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>  New
                </button>
            </td>
        </tr>
        <tr>
            <th>Body</th>
            <td>
                @foreach (var item in Model.BodyClothes)
                {
                    <p>
                        <button class="btn" onclick="deleteBody(@Model.Outfit.Id, @item.Id)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z" />
                            </svg>
                        </button>@item.Name
                    </p>
                }
                <div id="bodyClothesPart"></div>
                <button onclick="getClothes('body')" class="btn" name="newButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square" style="margin-right: 10px" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>  New
                </button>
            </td>
        </tr>
        <tr>
            <th>Arm</th>
            <td>
                @foreach (var item in Model.ArmClothes)
                {
                    <p>
                        <button class="btn" onclick="deleteArm(@Model.Outfit.Id, @item.Id)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z" />
                            </svg>
                        </button>@item.Name
                    </p>
                }
                <div id="armClothesPart"></div>
                <button onclick="getClothes('arm')" class="btn" name="newButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square" style="margin-right: 10px" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>  New
                </button>
            </td>
        </tr>
        <tr>
            <th>Legs</th>
            <td>
                @foreach (var item in Model.LegsClothes)
                {
                    <p>
                        <button class="btn" onclick="deleteLegs(@Model.Outfit.Id, @item.Id)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z" />
                            </svg>
                        </button>@item.Name
                    </p>
                }
                <div id="legsClothesPart"></div>
                <button onclick="getClothes('legs')" class="btn" name="newButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square" style="margin-right: 10px" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>  New
                </button>
            </td>
        </tr>
        <tr>
            <th>Feet</th>
            <td>
                @foreach (var item in Model.FeetClothes)
                {
                    <p>
                        <button class="btn" onclick="deleteFeet(@Model.Outfit.Id, @item.Id)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z" />
                            </svg>
                        </button>@item.Name
                    </p>
                }
                <div id="feetClothesPart"></div>
                <button onclick="getClothes('feet')" class="btn" name="newButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square" style="margin-right: 10px" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>  New
                </button>
            </td>
        </tr>
    </table>

    <button class="btn text-white" onclick="saveClothes()" style="background-color:#1e309a;" type="submit" role="button">Update</button>
</div>




<script>
    function getClothes(thispart) {
        var inPart = document.getElementById(thispart + 'ClothesPart');
         
        $.ajax({
            url: "/Outfit/GetClothes/?part=" + thispart
        }).done(function (data) {
            
            var newNode = document.createElement('select');
            newNode.className = "form-select form-control";
            for (let a = 0; a < data.length; a++) {
                newNode.innerHTML += '<option value="' + data[a].id + '">' + data[a].name + '</option>';
            }
            newNode.innerHTML += '</select>';
            inPart.appendChild(newNode);
            inPart.nextElementSibling.style.display = "none";
        });
    }

    function deleteHead(oID, hID) {
        var value = "head|" + oID + "|" + hID;
        $.ajax({
            url: "/Outfit/DeleteCloth/?value=" + value
        }).done(function (data) {
            window.location.href = '/Outfit/Update/' + oID;
        });
    }
    function deleteBody(oID, hID) {
        var value = "body|" + oID + "|" + hID;
        $.ajax({
            url: "/Outfit/DeleteCloth/?value=" + value
        }).done(function (data) {
            window.location.href = '/Outfit/Update/' + oID;
        });
    }
    function deleteArm(oID, hID) {
        var value = "arm|" + oID + "|" + hID;
        $.ajax({
            url: "/Outfit/DeleteCloth/?value=" + value
        }).done(function (data) {
            window.location.href = '/Outfit/Update/' + oID;
        });
    }
    function deleteLegs(oID, hID) {
        var value = "legs|" + oID + "|" + hID;
        $.ajax({
            url: "/Outfit/DeleteCloth/?value=" + value
        }).done(function (data) {
            window.location.href = '/Outfit/Update/' + oID;
        });
    }
    function deleteFeet(oID, hID) {
        var value = "feet|" + oID + "|" + hID;
        $.ajax({
            url: "/Outfit/DeleteCloth/?value=" + value
        }).done(function (data) {
            window.location.href = '/Outfit/Update/' + oID;
        });
    }

    function saveClothes() {
        var outfitID = @Model.Outfit.Id;
        var outfitName = document.getElementById('name').value;

        var headClothIds= document.getElementById("headClothesPart").firstChild.value;
        var bodyClothIds = document.getElementById("bodyClothesPart").firstChild.value;
        var armClothIds = document.getElementById("armClothesPart").firstChild.value;
        var legsClothIds = document.getElementById("legsClothesPart").firstChild.value;
        var feetClothIds = document.getElementById("feetClothesPart").firstChild.value;

        var values = "" + outfitID + "|" + outfitName + "|" + headClothIds + "|" + bodyClothIds + "|" + armClothIds + "|" + legsClothIds + "|" + feetClothIds;

        $.ajax({
            url: "/Outfit/UpdateOutfit/?value="+values
        }).done(function (data) {
            window.location.href = '/Outfit/Index/';
        });
    }

    @*function saveClothes() {
        var outfitID = @Model.Outfit.Id;
        var outfitName = document.getElementById('name').value;

        var headIDs = [];
        for (var x of document.getElementById("headClothesPart").childNodes) {
            console.log(typeof (x.value));
            headIDs.push(x.value);
        }

        var bodyIDs = [];
        for (var x of document.getElementById("bodyClothesPart").childNodes) {
            bodyIDs.push(x.value);
        }

        var armIDs = [];
        for (var x of document.getElementById("armClothesPart").childNodes) {
            armIDs.push(x.value);
        }

        var legsIDs = [];
        for (var x of document.getElementById("legsClothesPart").childNodes) {
            legsIDs.push(x.value);
        }

        var feetIDs = [];
        for (var x of document.getElementById("feetClothesPart").childNodes) {
            feetIDs.push(x.value);
        }
       

        //var headClothIds= document.getElementById("headClothesPart").firstChild.value;
        //var bodyClothIds = document.getElementById("bodyClothesPart").firstChild.value;
        //var armClothIds = document.getElementById("armClothesPart").firstChild.value;
        //var legsClothIds = document.getElementById("legsClothesPart").firstChild.value;
        //var feetClothIds = document.getElementById("feetClothesPart").firstChild.value;

       // var values = "" + outfitID + "|" + outfitName + "|" + headClothIds + "|" + bodyClothIds + "|" + armClothIds + "|" + legsClothIds + "|" + feetClothIds;
        //var values = "" + outfitID + "|" + outfitName + "|" + headIDs + "|" + bodyIDs + "|" + armIDs + "|" + legsIDs + "|" + feetIDs;

        var allValues = [];
        allValues.push(outfitID);
        allValues.push("-");
        allValues.push(outfitName);
        allValues.push("-");
        allValues.push(headIDs);
        allValues.push("-");
        allValues.push(bodyIDs);
        allValues.push("-");
        allValues.push(armIDs);
        allValues.push("-");
        allValues.push(legsIDs);
        allValues.push("-");
        allValues.push(feetIDs);

        $.ajax({
            url: "/Outfit/UpdateOutfit/?value="+allValues,
            
        }).done(function (data) {
            window.location.href = '/Outfit/Index/';
        });
    }*@

</script>

<script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>